!function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}({10:function(e,t,r){e.exports=r(11)},11:function(e,t){function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,s){try{var o=t[a](s),i=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}return n("next")})}}var n=Stripe(give_stripe_vars.publishable_key);give_stripe_vars.stripe_account_id&&(n=Stripe(give_stripe_vars.publishable_key,{stripeAccount:give_stripe_vars.stripe_account_id})),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".give-form-wrap"),t=[],a=[],s=[],o="",i=give_stripe_vars.preferred_locale;Array.prototype.forEach.call(e,function(e){function u(){var e=d.querySelectorAll("ul.give-stripe-payment-tabs li a");null!==e&&Array.prototype.forEach.call(e,function(t){var r=d.querySelector(".give-submit-button-wrap"),n=d.querySelector(".give-stripe-payment-request-content"),a=d.querySelector("#give-stripe-payment-errors-"+v);r.style.display="block",n.style.display="none",t.addEventListener("click",function(t){var s=this.parentElement,o=d.querySelector(this.getAttribute("href"));if(Array.prototype.forEach.call(e,function(e){d.querySelector(e.getAttribute("href")).style.display="none",e.parentElement.className=""}),a.innerHTML="","#give-stripe-payment-request-content"===this.getAttribute("href")){if(r.style.display="none",n.style.display="block",!d.querySelector('input[name="is_payment_request"]')){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","is_payment_request"),i.setAttribute("value",!0),d.appendChild(i)}}else"#give-stripe-credit-card-content"===this.getAttribute("href")&&(n.style.display="none",r.style.display="block",d.querySelector('input[name="is_payment_request"]').remove());o.style.display="block",s.className=s.classList.contains("active")?s.classList:s.classList+"active",t.preventDefault()})})}function c(e,o){var i=this,u=d.querySelector('input[name="give-form-title"]'),c=Give.fn.unFormatCurrency(d.querySelector(".give-final-total-amount").dataset.total,d.dataset.decimal_separator);a[e]=n.paymentRequest({country:give_stripe_vars.base_country,currency:d.getAttribute("data-currency_code").toLowerCase(),total:{label:u.value,amount:Math.round(100*c)},requestShipping:!1,requestPayerName:!0}),!1===s[e]&&(t[e]=o.create("paymentRequestButton",{paymentRequest:a[e],style:{paymentRequestButton:{type:"donate",theme:give_stripe_vars.payment_request_button_style,height:"64px"}}}),s[e]=!0),a[e].canMakePayment().then(function(r){var n=document.getElementById("give-stripe-payment-request-button-"+e);n&&(r&&(t[e].mount("#give-stripe-payment-request-button-"+e),s[e]=!0),n.style.display="block")}),a[e].on("source",function(){var e=r(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.querySelector('input[name="give_stripe_source"]').value=t.source.id,d.querySelector('input[name="card_address"]').value=t.source.owner.address.line1,d.querySelector('input[name="card_address_2"]').value=t.source.owner.address.line2,d.querySelector('input[name="card_city"]').value=t.source.owner.address.city,d.querySelector('input[name="card_zip"]').value=t.source.owner.address.postal_code,l(t.source.owner.address.country),p(t.source.owner.address.country,t.source.owner.address.state),setTimeout(function(){d.submit(),t.complete("success")},2e3);case 8:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}()),t[e].on("click",function(t){var r=new XMLHttpRequest,n=new FormData(d),s=d.querySelector("#give-stripe-payment-errors-"+e);c=Give.fn.unFormatCurrency(d.querySelector(".give-final-total-amount").dataset.total,d.dataset.decimal_separator),n.append("action","give_process_donation"),n.append("give_ajax",!0),a[e].update({currency:d.getAttribute("data-currency_code").toLowerCase(),total:{label:u.value,amount:Math.round(100*c)}}),r.onreadystatechange=function(){4===this.readyState&&200===this.status&&"success"!==this.responseText?(t.preventDefault(),s.innerHTML=this.response):s.innerHTML=""},r.open("POST",give_global_vars.ajaxurl,!1),r.send(n)})}function l(e){for(var t=d.querySelector('select[name="billing_country"]'),r=t.getElementsByTagName("option"),n=0;n<r.length;n++)r[n].selected=!1,r[n].removeAttribute("selected"),r[n].value===e&&(r[n].selected=!0,r[n].setAttribute("selected","selected"))}function p(e,t){var r=new XMLHttpRequest,n=new FormData;n.append("action","give_get_states"),n.append("country",e),n.append("field_name","card_state"),r.onreadystatechange=function(){if(4===this.readyState&&200===this.status&&"success"!==this.responseText){var e=JSON.parse(this.response),r=d.querySelector("#give-card-state-wrap");r.querySelector('select[name="card_state"]').remove(),r.innerHTML=r.innerHTML+e.data;for(var n=d.querySelector('select[name="card_state"]'),a=n.getElementsByTagName("option"),s=0;s<a.length;s++)a[s].selected=!1,a[s].removeAttribute("selected"),a[s].value!==t&&a[s].textContent!==t||(a[s].selected=!0,a[s].setAttribute("selected","selected"))}},r.open("POST",give_global_vars.ajaxurl,!1),r.send(n)}var d=e.querySelector(".give-form"),y=n.elements({locale:i});null!==d.querySelector(".give-gateway-option-selected .give-gateway").value&&(o=d.querySelector(".give-gateway-option-selected .give-gateway").value);var v=d.getAttribute("data-id");s[v]=!1,Array.prototype.forEach.call(d.querySelectorAll(".give-gateway"),function(e){e.addEventListener("change",function(t){e.checked&&(o=e.value)})}),jQuery(document).on("give_gateway_loaded",function(e,t,r){"stripe"===o&&(u(),c(v,y))}),"stripe"===o&&(u(),c(v,y))})})}});
//# sourceMappingURL=give-stripe-payment-request.js.map